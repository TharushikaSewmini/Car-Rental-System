<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Admin Dash Board</title>

    <link rel="icon" href="assets/images/logo.png">
    <meta content="width=device-width initial-scale=1" name="viewport">
    <link href="assets/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="assets/css/css/all.min.css">

    <link href="assets/styles/AdminDashBoardForm.css" rel="stylesheet">
</head>
<body>
<!--Nav Bar-->
<nav class="navbar navbar-expand-lg bg-light" id="navbar">
    <div class="container-fluid">
        <img src="assets/images/logo.png" alt="Logo" width="80" height="60" class="d-inline-block align-text-top">
        <a class="navbar-brand" href="#">Easy Car Rental</a>
        <button class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                <li class="nav-item ms-3">
                    <a class="nav-link active" aria-current="page" href="#" style="font-weight: bold;" id="linkDashBoard">DashBoard</a>
                </li>
                <li class="nav-item ms-3">
                    <a class="nav-link active" href="#" style="font-weight: bold;" id="linkCars">Cars</a>
                </li>
                <li class="nav-item ms-3">
                    <a class="nav-link active" href="#" style="font-weight: bold;" id="linkCustomers">Customers</a>
                </li>
                <li class="nav-item ms-3">
                    <a class="nav-link active" href="#" style="font-weight: bold;" id="linkDrivers">Drivers</a>
                </li>
                <li class="nav-item ms-3">
                    <a class="nav-link active" href="#" style="font-weight: bold;" id="linkBookingRequest">Booking Request</a>
                </li>
                <li class="nav-item ms-3">
                    <a class="nav-link active" href="#" style="font-weight: bold;" id="linkBooking">Booking</a>
                </li>
                <li class="nav-item ms-3">
                    <a class="nav-link active" href="#" style="font-weight: bold;" id="linkPayment">Payment</a>
                </li>
            </ul>

            <!--navbar sign up,log out-->
            <ul class="navbar-nav me-6 mb-2 mb-lg-0" id="navbarSideContent" style="color: #1D314F;">
                <li class="nav-item me-4">
                    <i class="fa-solid fa-user"></i>
                    <a class="nav-link" href="#" style="padding-left: 0; display: inline-block; font-weight: bold; color: #1D314F;">Sign Up</a>
                </li>

                <li class="nav-item">
                    <i class="fa-solid fa-right-from-bracket"></i>
                    <a class="nav-link" href="#" style="padding-left: 0; display: inline-block; font-weight: bold; color: #1D314F;">Log Out</a>
                </li>

            </ul>
        </div>
    </div>
</nav>


<main class="container-fluid">

<!---------------DashBoard Page------------------>
    <!----Reg Users, Available Cars, Available Drivers, Total Bookings, Active Bookings, Maintenance Cars count----->
    <section class="mt-3" id="dashBoardPage">
        <h1 class="mt-3" style="text-align: center">Admin DashBoard</h1>

        <div class="row gy-3 mx-4" id="displayContainer">
            <div class="col-3 me-3">
                <div class="card mt-3 col-10 text-center mx-auto">
                    <div class="cName" style="background-color: #3498db">Registered Users</div>
                    <i class="cFont fa-solid fa-users mt-3" style="color: #3498db"></i>
                    <h2 class="card-text mt-2 mb-3" id="registeredUsersCount">00</h2>
                </div>
            </div>

            <div class="col-3 me-3">
                <div class="card mt-3 col-10 text-center mx-auto">
                    <div class="cName" style="background-color:#1abc9c">Available Cars</div>
                    <i class="cFont fa-solid fa-car mt-3" style="color: #1abc9c"></i>
                    <h2 class="card-text mt-2 mb-3" id="availableCarsCount">00</h2>
                </div>
            </div>

            <div class="col-3 me-3">
                <div class="card mt-3 col-10 text-center mx-auto">
                    <div class="cName" style="background-color: #9b59b6">Bookings</div>
                    <i class="cFont fa-solid fa-layer-group mt-3" style="color: #9b59b6"></i>
                    <h2 class="card-text mt-2 mb-3" id="bookingsCount">00</h2>
                </div>
            </div>

            <div class="col-3 me-3">
                <div class="card mt-3 col-10 text-center mx-auto">
                    <div class="cName" style="background-color: #e67e22">Available Drivers</div>
                    <i class="cFont fa-solid fa-user-group mt-3" style="color: #e67e22"></i>
                    <h2 class="card-text mt-2 mb-3" id="availableDriversCount">00</h2>
                </div>
            </div>

            <div class="col-3 me-3">
                <div class="card mt-3 col-10 text-center mx-auto">
                    <div class="cName" style="background-color: #f1c40f">Active Bookings</div>
                    <i class="cFont fa-solid fa-key mt-3" style="color: #f1c40f"></i>
                    <h2 class="card-text mt-2 mb-3" id="activeBookingsCount">00</h2>
                </div>
            </div>

            <div class="col-3 me-3">
                <div class="card mt-3 col-10 text-center mx-auto">
                    <div class="cName" style="background-color: #ff5542">Maintenance Cars</div>
                    <i class="cFont fa-solid fa-screwdriver-wrench mt-3" style="color: #ff5542"></i>
                    <h2 class="card-text mt-2 mb-3" id="maintenanceCarsCount">00</h2>
                </div>
            </div>
        </div>

    </section>

    <!--------------Car Page------------------>
    <section class="container-fluid" id="carPage">
        <h1 class="mt-3" style="text-align: center">Cars Management</h1>

        <!----------Car Form-------->
        <form class="row g-3 mt-2 mx-5" id="carForm">
            <div class="col-md-3">
                <label for="txtRegNo" class="form-label">Registration No</label>
                <input type="text" class="form-control" id="txtRegNo" name="regNo">
            </div>
            <div class="col-md-3">
                <label for="txtBrand" class="form-label">Brand</label>
                <input type="text" class="form-control" id="txtBrand" name="brand">
            </div>

            <div class="col-3">
                <label for="txtNoOfPassengers" class="form-label">No of Passengers</label>
                <input type="number" class="form-control" id="txtNoOfPassengers" name="noOfPassengers">
            </div>

            <div class="col-3 mt-3">
                <div>
                <label for="selectColor" class="form-label">Color</label>
                <input type="color" class="form-control" id="selectColor" name="color">
                </div>
            </div>

            <div class="col-md-3 mt-3">
                <label for="selectType" class="form-label">Type</label>
                <select id="selectType" class="form-select" name="type">
                    <option selected hidden>Choose...</option>
                    <option>General</option>
                    <option>Premium</option>
                    <option>Luxury</option>
                </select>
            </div>

            <div class="col-md-3 mt-3">
                <label for="selectTransmissionType" class="form-label">Transmission Type</label>
                <select id="selectTransmissionType" class="form-select" name="transmissionType">
                    <option selected hidden>Choose...</option>
                    <option>Manual</option>
                    <option>Auto</option>
                </select>
            </div>

            <div class="col-md-3 mt-3">
                <label for="selectFuelType" class="form-label">Fuel Type</label>
                <select id="selectFuelType" class="form-select" name="fuelType">
                    <option selected hidden>Choose...</option>
                    <option>Diesel</option>
                    <option>Petrol</option>
                </select>
            </div>

<!--            <div class="col-3">-->
<!--                <div>-->
<!--                <label for="selectCarImages" class="form-label">Upload Car Images</label>-->
<!--                <input class="form-control" accept="image/*" type="file" id="selectCarImages" multiple name="selectCarImages" onchange="document.getElementById('carImage1').src = window.URL.createObjectURL(this.files[0])">-->
<!--            </div>-->
<!--            </div>-->

<!--            &lt;!&ndash;&#45;&#45;&#45;&#45;Images of Car-&#45;&#45;&#45;&#45;&ndash;&gt;-->
<!--            <div class="d-flex justify-content-center" >-->
<!--&lt;!&ndash;                <img alt="Image" id="mainImage" src="">&ndash;&gt;-->
<!--                <div class="col-md-3 mx-4" style="width: 200px; height: 120px; border: 1px solid black;">-->
<!--                    <img alt="Image" id="carImage1" src="">-->
<!--                </div>-->
<!--                <div class="col-md-3 mx-4" style="width: 200px; height: 120px; border: 1px solid black;" id="carImage2"></div>-->
<!--                <div class="col-md-3 mx-4" style="width: 200px; height: 120px; border: 1px solid black;" id="carImage3"></div>-->
<!--                <div class="col-md-3 mx-4" style="width: 200px; height: 120px; border: 1px solid black;" id="carImage4"></div>-->
<!--            </div>-->


            <div class="col-3">
                <div class="input-group-m">
                    <label for="fileString1" class="form-label">Upload Picture</label>
                    <input class="form-control mt-2" formenctype="multipart/form-data" name="fileString[]" type="file" id="fileString1" aria-describedby="inputGroup-sizing-lg" multiple>
                </div>
<!--                <div class="input-group-m">-->
<!--                    <label for="fileString2" class="form-label">Upload Back Picture</label>-->
<!--                    <input class="form-control mt-2" name="fileString2" type="file" id="fileString2" aria-describedby="inputGroup-sizing-lg" multiple>-->
<!--                </div>-->
<!--                <div class="input-group-m">-->
<!--                    <label for="fileString3" class="form-label">Upload Side Picture</label>-->
<!--                    <input class="form-control mt-2" name="fileString3" type="file" id="fileString3" aria-describedby="inputGroup-sizing-lg" multiple>-->
<!--                </div>-->
<!--                <div class="input-group-m">-->
<!--                    <label for="fileString4" class="form-label">Upload Interior Picture</label>-->
<!--                    <input class="form-control mt-2" name="fileString4" type="file" id="fileString4" aria-describedby="inputGroup-sizing-lg" multiple>-->
<!--                </div>-->
            </div>


            <!------Images of Car------->
            <div class="d-flex justify-content-center" >
                <!--                <img alt="Image" id="mainImage" src="">-->
                <div class="col-md-3 mx-4" style="width: 200px; height: 140px; border: 1px solid black;" id="carImageContent1">
                    <img alt="Image" id="carImage1" src="" style="width: 100%; height: 100%;">
                </div>
                <div class="col-md-3 mx-4" style="width: 200px; height: 120px; border: 1px solid black;" id="carImageContent2">
                    <img alt="Image" id="carImage2" src="" style="width: 100%; height: 100%;">
                </div>
                <div class="col-md-3 mx-4" style="width: 200px; height: 120px; border: 1px solid black;" id="carImageContent3">
                    <img alt="Image" id="carImage3" src="" style="width: 100%; height: 100%;">
                </div>
                <div class="col-md-3 mx-4" style="width: 200px; height: 120px; border: 1px solid black;" id="carImageContent4">
                    <img alt="Image" id="carImage4" src="" style="width: 100%; height: 100%;">
                </div>
            </div>

<!--            <div class="col-md-3 mt-3"></div>-->

            <div class="col-md-3 mt-3">
                <label for="txtDailyRate" class="form-label">Daily Rate</label>
                <input type="number" class="form-control" id="txtDailyRate" name="dailyRate">
            </div>

            <div class="col-md-3 mt-3">
                <label for="txtMonthlyRate" class="form-label">Monthly Rate</label>
                <input type="number" class="form-control" id="txtMonthlyRate" name="monthlyRate">
            </div>

            <div class="col-md-3 mt-3">
                <label for="txtLossDamageWaiver" class="form-label">Loss Damage Waiver</label>
                <input type="number" class="form-control" id="txtLossDamageWaiver" name="lossDamageWaiver">
            </div>

            <div class="col-md-3 mt-3"></div>

            <div class="col-md-3 mt-3">
                <label for="txtFreeKMForDay" class="form-label">Free KM for Day</label>
                <input type="number" class="form-control" id="txtFreeKMForDay" name="freeKMForDay">
            </div>

            <div class="col-md-3 mt-3">
                <label for="txtFreeKMForMonth" class="form-label">Free KM for Month</label>
                <input type="number" class="form-control" id="txtFreeKMForMonth" name="freeKMForMonth">
            </div>

            <div class="col-md-3 mt-3">
                <label for="txtPriceForExtraKM" class="form-label">Price Per Extra KM</label>
                <input type="number" class="form-control" id="txtPriceForExtraKM" name="priceForExtraKM">
            </div>

            <div class="col-md-3 mt-3">
                <label for="selectCarStatus" class="form-label">Status</label>
                <select id="selectCarStatus" class="form-select" name="status">
                    <option selected hidden>Choose...</option>
                    <option>Available</option>
                    <option>Under Maintenance</option>
                    <option>On Hire</option>
                </select>
            </div>

            <div class="col-md-10 mt-4 mx-auto">
                <button type="button" class="btn btn-success col-2 ms-5" id="btnSaveCar">Save</button>
                <button type="button" class="btn btn-primary col-2 ms-2" id="btnUpdateCar">Update</button>
                <button type="button" class="btn btn-danger col-2 ms-2" id="btnDeleteCar">Delete</button>
                <button type="button" class="btn btn-warning col-2 ms-2" id="btnGetAllCars">View All Cars</button>
                <button type="button" class="btn btn-info col-2 ms-2" id="btnAddNewCar">Add New Car</button>
            </div>
        </form>


        <form class="d-flex mt-5 col-5 mx-auto" role="search">
            <input class="form-control me-2" type="search" id="txtSearchCar" placeholder="Input Car Reg No" aria-label="Search">
            <button class="btn btn-secondary" type="button" id="btnSearchCar" style="color: white;">Search</button>
        </form>


        <!-------Car Table------->
        <section class="mt-4 mx-5">
            <table class="table table-striped">
                <thead>
                <tr>
                    <th scope="col">Reg No</th>
                    <th scope="col">Brand</th>
                    <th scope="col">Type</th>
                    <th scope="col">Color</th>
                    <th scope="col">No of Passengers</th>
                    <th scope="col">Transmission Type</th>
                    <th scope="col">Fuel Type</th>
                    <th scope="col">Daily Rate</th>
                    <th scope="col">Monthly Rate</th>
                    <th scope="col">Loss Damage Waiver</th>
                    <th scope="col">Free KM for a Day</th>
                    <th scope="col">Free KM for a Month</th>
                    <th scope="col">Price for Extra KM</th>
                    <th scope="col">Status</th>
                </tr>
                </thead>
                <tbody id="tblCar">
                <tr></tr>
                </tbody>
            </table>
        </section>

    </section>

    <!--------------Customer Page------------------>
    <section class="container" id="customerPage">
        <h1 class="mt-3" style="text-align: center">Customer Details</h1>

        <!--Customer Search-->
        <div class="d-flex col-5 m-auto" role="search">
            <input class="form-control me-2" type="search" id="txtSearchCustomer" placeholder="Search" aria-label="Search">
            <button class="btn btn-outline-success" type="button" id="searchCustomer">Search</button>
        </div>

        <!-------Customer Details Table------->
        <section class="mt-4">
            <table class="table table-striped">
                <thead>
                <tr>
                    <th scope="col">Customer ID</th>
                    <th scope="col">Customer Name</th>
                    <th scope="col">Address</th>
                    <th scope="col">Contact No</th>
                    <th scope="col">Email</th>
                    <th scope="col">NIC</th>
                    <th scope="col">Driving License Number</th>
                </tr>
                </thead>
                <tbody id="tblCustomerDetails">
                <tr></tr>
                </tbody>
            </table>
        </section>

    </section>

    <!--------------Driver Page------------------>
    <section class="container-fluid" id="driverPage">
        <h1 class="mt-3" style="text-align: center">Driver Management</h1>

        <!--Driver form-->
        <div class="col-3" style="display: inline-block; margin-left: 70px;">
            <form class="row g-3" id="driverForm">
                <div class="col-md-12">
                    <label for="txtDriverID" class="form-label">Driver ID</label>
                    <input class="form-control" type="text" id="txtDriverID" name="driverId">
                </div>
                <div class="col-md-12 my-1">
                    <label for="txtDriverName" class="form-label">Full Name</label>
                    <input type="text" class="form-control" id="txtDriverName" placeholder="Nimal Perera" name="driverName">
                </div>
                <div class="col-md-12 my-1">
                    <label for="txtDriverContact" class="form-label">Contact No</label>
                    <input type="text" class="form-control" id="txtDriverContact" placeholder="0712834555" name="driverContact">
                </div>
                <div class="col-md-12 my-0">
                    <label for="txtDriverUserName" class="form-label">UserName</label>
                    <input type="text" class="form-control" id="txtDriverUserName" placeholder="nimal" name="driverUsername">
                </div>
                <div class="col-md-12 my-0">
                    <label for="txtDriverPassword" class="form-label">Password</label>
                    <input type="password" class="form-control" id="txtDriverPassword" name="driverPassword">
                </div>
                <div class="col-md-12 my-0">
                    <label for="selectedDriverStatus" class="form-label">Status</label>
                    <select id="selectedDriverStatus" class="form-select" name="driverStatus">
                        <option selected hidden></option>
                        <option>Available</option>
                        <option>Not Available</option>
                        <option>On Hire</option>
                    </select>
                </div>

                <div class="col-12 mx-0 px-0 mt-4">
                    <button type="button" class="btn btn-success px-4" id="btnSaveDriver">Save</button>
                    <button type="button" class="btn btn-primary" id="btnUpdateDriver">Update</button>
                    <button type="button" class="btn btn-danger" id="btnDeleteDriver">Delete</button>
                    <button type="button" class="btn btn-warning" id="btnViewAllDrivers">View All Drivers</button>
                </div>
            </form>
        </div>

        <section class="col-md-7" style="display: inline-block; margin-left: 80px;" id="viewDriver">
            <!--Driver Search-->
            <aside class="col-6 mx-auto mt-4" id="driverSearch">
                <form class="d-flex" role="search">
                    <input class="form-control me-2" type="search" id="txtSearchDriver" placeholder="Input Driver ID/Name" aria-label="Search">
                    <button class="btn btn-secondary" type="button" id="btnSearchDriver" style="color: white;">Search</button>
                </form>
            </aside>

            <!--Driver Table-->
            <section class="mt-4">
                <table class="table table-striped">
                    <thead style="background-color: #8E44AD; color: white;">
                    <tr>
                        <th scope="col">Driver ID</th>
                        <th scope="col">Name</th>
                        <th scope="col">Contact</th>
                        <th scope="col">Username</th>
                        <th scope="col">Password</th>
                        <th scope="col">Status</th>
                    </tr>
                    </thead>
                    <tbody id="tblDriver">
                    <tr></tr>
                    </tbody>
                </table>
            </section>
        </section>

    </section>

    <!--------------Rent Request Page------------------>
    <section class="container-fluid" id="bookingRequestPage">
        <h1 class="mt-3" style="text-align: center">Rent Request Management</h1>

        <section class="d-flex justify-content-center">
        <!--Booking Request form-->
        <div class="col-3 mt-1 px-0" style="display: inline-block;">
            <form class="row g-3" id="bookingRequestForm">
                <div class="col-md-6">
                    <label for="txtLoadBookingRequestId" class="form-label my-1">Booking ID</label>
                    <input class="form-control" type="text" id="txtLoadBookingRequestId" name="bookingId" disabled>
                </div>
                <div class="col-md-6">
                    <label for="txtLoadBookingDate" class="form-label my-1">Booking Date</label>
                    <input type="text" class="form-control" id="txtLoadBookingDate" name="bookingDate" disabled>
                </div>
                <div class="col-md-6 my-1">
                    <label for="txtLoadCustomerName" class="form-label my-1">Customer Name</label>
                    <input type="text" class="form-control" id="txtLoadCustomerName" name="customerName" disabled>
                </div>
                <div class="col-md-6 my-1">
                    <label for="txtLoadCustomerEmail" class="form-label my-1">Customer Email</label>
                    <input type="text" class="form-control" id="txtLoadCustomerEmail" name="customerEmail" disabled>
                </div>
                <div class="col-md-6 my-1">
                    <label for="txtLoadCarRegNo" class="form-label my-1">Car Reg No</label>
                    <input type="text" class="form-control" id="txtLoadCarRegNo" name="carRegNo" disabled>
                </div>
                <div class="col-md-6 my-1">
                    <label for="txtLoadDriverId" class="form-label my-1">Driver ID</label>
                    <input type="text" class="form-control" id="txtLoadDriverId" name="driverId" disabled>
                </div>
                <div class="col-md-6 my-1">
                    <label for="txtLoadPickupDate" class="form-label my-1">Pickup Date</label>
                    <input type="text" class="form-control" id="txtLoadPickupDate" name="pickupDate" disabled>
                </div>
                <div class="col-md-6 my-1">
                    <label for="txtLoadReturnDate" class="form-label my-1">Return Date</label>
                    <input type="text" class="form-control" id="txtLoadReturnDate" name="returnDate" disabled>
                </div>
                <div class="col-md-10 my-1">
                    <label for="txtLoadBookingStatus" class="form-label my-1">Status</label>
                    <input type="text" class="form-control" id="txtLoadBookingStatus" name="bookingStatus" disabled>
                </div>
                <div class="col-md-12 my-0">
                    <label for="selectAnotherDriver" class="form-label my-1">Change Driver</label>
                    <select id="selectAnotherDriver" class="form-select" name="anotherDriver">
                        <option selected disabled>Select Another Driver</option>
                    </select>
                </div>
                <div class="col-md-12 my-1">
                    <label for="txtDenialReason" class="form-label my-1">Denial Reason</label>
                    <input type="text" class="form-control" id="txtDenialReason" name="denialReason">
                </div>

                <div class="col-12 mx-auto px-auto d-flex justify-content-center">
                    <button type="button" class="btn btn-success col-md-4" id="btnAcceptRequest">Accept</button>
                    <button type="button" class="btn btn-danger col-md-4 mx-4" id="btnDenyRequest">Deny</button>
                </div>
            </form>
        </div>

        <!--Rent Request Table-->
        <section class="col-8 mt-4" style="display: inline-block; margin-left: 30px;">
            <table class="table table-striped" style="margin-left: 30px;">
                <thead style="background-color: #8E44AD; color: white;">
                <tr>
                    <th scope="col">Booking ID</th>
                    <th scope="col">Booking Date</th>
                    <th scope="col">Customer Name</th>
                    <th scope="col">Customer Email</th>
                    <th scope="col">Car RegNo</th>
                    <th scope="col">Driver ID</th>
                    <th scope="col">Pickup Date</th>
                    <th scope="col">Return Date</th>
                    <th scope="col">Status</th>
                </tr>
                </thead>
                <tbody id="tblBookingRequest">
                <tr></tr>
                </tbody>
            </table>
        </section>
        </section>
    </section>

    <!--------------Booking Page------------------>
    <section class="container" id="bookingPage">
        <h1 class="mt-3" style="text-align: center">Booking Management</h1>

        <!--Booking Table-->
        <section class="mt-4">
            <table class="table table-striped">
                <thead style="background-color: #8E44AD; color: white;">
                <tr>
                    <th scope="col">Booking ID</th>
                    <th scope="col">Booking Date</th>
                    <th scope="col">Customer Name</th>
                    <th scope="col">Customer Email</th>
                    <th scope="col">Car RegNo</th>
                    <th scope="col">Driver ID</th>
                    <th scope="col">Pickup Date</th>
                    <th scope="col">Return Date</th>
                    <th scope="col">Status</th>
                </tr>
                </thead>
                <tbody id="tblBooking">
                <tr></tr>
                </tbody>
            </table>
        </section>

    </section>

    <!--------------Payment Page------------------>
    <section  class="container" id="paymentPage">
        <h2 class="mt-3" style="text-align: center">Payment Management</h2>

        <!--Search Booking-->
        <aside class="col-6 mx-auto mt-4" id="bookingSearch">
            <form class="d-flex" role="search">
                <input class="form-control me-2" type="search" id="txtSearchBooking" placeholder="Type Booking ID" aria-label="Search">
                <button class="btn btn-secondary" type="button" id="btnSearchBooking" style="color: white;">Search</button>
            </form>
        </aside>

        <!----------Payment Form-------->
        <form class="row g-3 mt-2" id="paymentForm">
            <div class="col-md-3 mt-3">
                <label for="txtLoadBookingId" class="form-label mb-1">Booking Id</label>
                <input type="text" class="form-control" id="txtLoadBookingId" name="loadBookingId" disabled>
            </div>
            <div class="col-md-3 mt-3">
                <label for="txtDate" class="form-label mb-1">Date</label>
                <input type="text" class="form-control" id="txtDate" name="date" disabled>
            </div>
            <div class="col-md-3 mt-3">
                <label for="txtPickup" class="form-label mb-1">Pickup Date</label>
                <input type="text" class="form-control" id="txtPickup" name="pickup" disabled>
            </div>
            <div class="col-md-3 mt-3">
                <label for="txtReturn" class="form-label mb-1">Return Date</label>
                <input type="text" class="form-control" id="txtReturn" name="return" disabled>
            </div>
            <div class="col-md-3 mt-3">
                <label for="txtLossDamageWaiverPaidAmount" class="form-label mb-1">Loss Damage Waiver Paid Amount</label>
                <input type="text" class="form-control" id="txtLossDamageWaiverPaidAmount" name="lossDamageWaiverPaidAmount" disabled>
            </div>
            <div class="col-md-2 mt-3">
                <label for="txtDamageCost" class="form-label mb-1">Damage Cost</label>
                <input type="text" class="form-control" id="txtDamageCost" name="damageCost">
            </div>
            <div class="col-md-3 mt-3">
                <label for="txtRemain" class="form-label mb-1">Remain Balance</label>
                <input type="text" class="form-control" id="txtRemain" disabled>
            </div>
            <div class="col-md-2 mt-3">
                <label for="txtLoadDriverId1" class="form-label mb-1">Driver Id</label>
                <input type="text" class="form-control" id="txtLoadDriverId1" name="driverId1" disabled>
            </div>
            <div class="col-md-2 mt-3">
                <label for="txtDriverPayment" class="form-label mb-1">Driver Payments</label>
                <input type="text" class="form-control" id="txtDriverPayment" name="driverPayment">
            </div>
            <div class="col-md-3 mt-3">
                <label for="txtRentDuration" class="form-label mb-1">Rent Duration</label>
                <input type="text" class="form-control" id="txtRentDuration" disabled>
            </div>
            <div class="col-md-3 mt-3">
                <label for="txtLoadDailyRate" class="form-label mb-1">Daily Rate</label>
                <input type="text" class="form-control" id="txtLoadDailyRate" disabled>
            </div>
            <div class="col-md-3 mt-3">
                <label for="txtRentForUsingDays" class="form-label mb-1">Rent for Using Days</label>
                <input type="text" class="form-control" id="txtRentForUsingDays" name="rentForUsingDays" disabled>
            </div>
            <div class="col-md-3 mt-3">
            </div>
            <div class="col-md-3 mt-3">
                <label for="txtTotalKM" class="form-label mb-1">Total KM</label>
                <input type="text" class="form-control" id="txtTotalKM" name="totalKM">
            </div>
            <div class="col-md-3 mt-3">
                <label for="txtCostForExtraKM" class="form-label mb-1">Price for Extra KM</label>
                <input type="text" class="form-control" id="txtCostForExtraKM" disabled>
            </div>
            <div class="col-md-3 mt-3">
                <label for="txtExtraKM" class="form-label mb-1">Extra KM</label>
                <input type="text" class="form-control" id="txtExtraKM" disabled>
            </div>
            <div class="col-md-3 mt-3">
                <label for="txtTotalCostForExtraKM" class="form-label mb-1">Total Cost for Extra KM</label>
                <input type="text" class="form-control" id="txtTotalCostForExtraKM" name="totalCostForExtraKM" disabled>
            </div>
            <div class="col-md-6 mx-auto me-auto mt-2">
                <button type="button" class="btn btn-primary col-4 mx-5 mt-3" id="btnCalculate">Calculate</button>
            </div>
            <hr class="hr mx-auto mt-3">
            <div class="col-md-3 mt-3">
                <label for="txtTotalPayment" class="form-label">Total Payment</label>
                <input type="text" class="form-control" id="txtTotalPayment" name="totalPayment" disabled>
            </div>
            <div class="col-md-3 mt-3">
                <label for="txtCash" class="form-label">Cash</label>
                <input type="text" class="form-control" id="txtCash" name="cash">
            </div>
            <div class="col-md-3 mt-3">
                <label for="txtBalance" class="form-label">Balance</label>
                <input type="text" class="form-control" id="txtBalance" name="balance" disabled>
            </div>
            <div class="col-2 mx-auto mt-5">
                <button type="button" class="btn btn-success col-12" id="btnPaid">Paid</button>
<!--                <button type="button" class="btn btn-danger col-3 mx-5" id="btnCancelCustomer">Cancel</button>-->
            </div>
        </form>
    </section>

</main>

<script src="assets/js/jquery-3.6.1.min.js"></script>
<script src="assets/js/bootstrap.min.js"></script>

<script src="assets/js/Navigations.js"></script>
<script>

    let baseURL = "http://localhost:8080/EasyCarRentalApp/";

//===========================DashBoard============================
    $(document).ready(function () {
        getRegisteredUsersCount();
    });

    function getRegisteredUsersCount(){
        $.ajax ({
            url: baseURL + "customer/rCustomerCount",
            dataType: "json",
            success: function (resp) {
                let rCustomerCount = resp.data;
                console.log(resp);
                $("#fileString1").text(rCustomerCount);
            }
        });
    }


//===========================Car============================
    loadAllCars();

    //------------Add Car Images----------------
    $("#fileString1").change(function (){
        console.log($('#fileString1').val());
        $("#carImage1").attr('src',window.URL.createObjectURL(this.files[0]));
        $("#carImage2").attr('src',window.URL.createObjectURL(this.files[1]));
        $("#carImage3").attr('src',window.URL.createObjectURL(this.files[2]));
        $("#carImage4").attr('src',window.URL.createObjectURL(this.files[3]));

        // console.log($('#carImage1').val());
        // onchange="document.getElementById('carImage1').src = window.URL.createObjectURL(this.files[0])";
    });

    // $("#fileString2").change(function (){
    //     console.log($('#fileString2').val());
    //     $("#carImage2").attr('src',window.URL.createObjectURL(this.files[0]));
    // });
    //
    // $("#fileString3").change(function (){
    //     console.log($('#fileString3').val());
    //     $("#carImage3").attr('src',window.URL.createObjectURL(this.files[0]));
    // });
    //
    // $("#fileString4").change(function (){
    //     console.log($('#fileString4').val());
    //     $("#carImage4").attr('src',window.URL.createObjectURL(this.files[0]));
    // });

    // imageLoad();
    // function imageLoad() {
    //     $.ajax({
    //         url: baseUrl + "uploads/lastImageLoad",
    //         method: 'get',
    //         success: function (resp) {
    //             console.log(resp.data);
    //             url1 = resp.data
    //             $("#display").css({
    //                 "background": `url(${baseUrl + url1})`, "background-size": "cover"
    //             });
    //         },
    //         error: function (err) {
    //             console.log(err);
    //         }
    //     });
    // }

    //----------------Bind Data to InputFields--------------
    function bindCarTableRowClickEvents() {
        $("#tblCar>tr").click(function () {
            let regNo = $(this).children(":eq(0)").text();
            let brand = $(this).children(":eq(1)").text();
            let type = $(this).children(":eq(2)").text();
            let color = $(this).children(":eq(3)").text();
            let noOfPassengers = $(this).children(":eq(4)").text();
            let transmissionType = $(this).children(":eq(5)").text();
            let fuelType = $(this).children(":eq(6)").text();
            let dailyRate = $(this).children(":eq(7)").text();
            let monthlyRate = $(this).children(":eq(8)").text();
            let lossDamageWaiver = $(this).children(":eq(9)").text();
            let freeKMForDay = $(this).children(":eq(10)").text();
            let freeKMForMonth = $(this).children(":eq(11)").text();
            let priceForExtraKM = $(this).children(":eq(12)").text();
            let status = $(this).children(":eq(13)").text();

            $("#txtRegNo").val(regNo);
            $("#txtBrand").val(brand);
            $("#selectType").val(type);
            $("#selectColor").val(color);
            $("#txtNoOfPassengers").val(noOfPassengers);
            $("#selectTransmissionType").val(transmissionType);
            $("#selectFuelType").val(fuelType);
            $("#txtDailyRate").val(dailyRate);
            $("#txtMonthlyRate").val(monthlyRate);
            $("#txtLossDamageWaiver").val(lossDamageWaiver);
            $("#txtFreeKMForDay").val(freeKMForDay);
            $("#txtFreeKMForMonth").val(freeKMForMonth);
            $("#txtPriceForExtraKM").val(priceForExtraKM);
            $("#selectCarStatus").val(status);
            imageLoad($("#txtRegNo").val());

        });
    }

    //----------------Clear InputFields--------------
    function setCarFormTextFieldValues(regNo,brand,type,color,noOfPassengers,transmissionType,fuelType,dailyRate,monthlyRate,lossDamageWaiver,freeKMForDay,freeKMForMonth,priceForExtraKM,status){
        $("#txtRegNo").val(regNo);
        $("#txtBrand").val(brand);
        $("#selectType").val(type);
        $("#selectColor").val(color);
        $("#txtNoOfPassengers").val(noOfPassengers);
        $("#selectTransmissionType").val(transmissionType);
        $("#selectFuelType").val(fuelType);
        $("#txtDailyRate").val(dailyRate);
        $("#txtMonthlyRate").val(monthlyRate);
        $("#txtLossDamageWaiver").val(lossDamageWaiver);
        $("#txtFreeKMForDay").val(freeKMForDay);
        $("#txtFreeKMForMonth").val(freeKMForMonth);
        $("#txtPriceForExtraKM").val(priceForExtraKM);
        $("#selectCarStatus").val(status);
        $("#fileString1").val(null);
        $("#carImage1, #carImage2, #carImage3, #carImage4").attr("src","");
    }

    // $("#btnUpload").click(function (){
    //     let formData = new FormData($("#formFile")[0]);
    //     $.ajax({
    //         url: baseURL + "car/images",
    //         method: 'post',
    //         async: true,
    //         contentType: false,
    //         processData: false,
    //         data: formData,
    //         success: function (resp) {
    //             alert("Successfully upload;");
    //             // imageLoad();
    //         },
    //         error: function (err) {
    //             console.log(err);
    //         }
    //     });
    // });

    //----------------Save Car--------------
    $("#btnSaveCar").click(function (){
        var formData = $("#carForm").serialize();

        console.log(formData);
        $.ajax({
            url: baseURL+"car",
            method: "post",
            async: true,
            data: formData,
            dataType: "json",
            success: function (resp){
                alert(resp.message);
                uploadImages();
                setCarFormTextFieldValues("","","","");
                loadAllCars();
            },
            error: function (error){
                var jsObject = JSON.parse(error.responseText);
                alert(jsObject);
            }
        });
    });


    function uploadImages(){
        let carRegNo = $("#txtRegNo").val();

        let formData = new FormData();
        var filesCount = $("#fileString1")[0].files.length;
        console.log("count"+filesCount);

        for(var i=0; i<filesCount; i++){
            // formData.append("fileString[]", $("#fileString1")[0].files[i], carRegNo+"-"+($("#fileString1")[0].files[i].name));

            formData.append("fileString[]", $("#fileString1")[0].files[i], ($("#fileString1")[0].files[i].name)+"-"+carRegNo);
        }

        console.log("Start"+formData);
//-------------------------------------------


        // let imageFile = $("#fileString")[0].files[0];
        // var fileName= carRegNo+"-"+($("#fileString")[0].files[0].name);
        //
        // let formData = new FormData();
        // formData.append("fileString", imageFile, fileName);





        // let formData = new FormData($("#formFile")[0], carRegNo);

        // console.log("Start"+imageFile);
        $.ajax({
            url: baseURL + "car/images",
            method: 'post',
            async: true,
            contentType: false,
            processData: false,
            data: formData,
            dataType: "json",
            success: function (resp) {
                alert("Successfully images upload;");
            },
            error: function (err) {
                console.log(err);
            }
        });
    }


    function imageLoad(carregNo) {
        // var carRegNo = $("#txtRegNo").val();
        var carRegNo = carregNo;
        console.log("Image"+carRegNo);
        $.ajax({
            url: baseURL + "car?regNo="+carRegNo+"",
            method: 'get',
            success: function (resp) {
                console.log(resp.data);
                url1 = resp.data[0];
                url2 = resp.data[1];
                url3 = resp.data[2];
                url4 = resp.data[3];


                console.log("image1:"+url1);
                console.log("image2:"+url2);
                console.log("image3:"+url3);
                console.log("image4:"+url4);


                // var fileName= (url1).split('-')[1];

                // $("#carImage2").css({
                //     "background": `url(${baseURL+url1})`, "background-size": "cover"
                // });

                $("#carImage1").attr("src", baseURL + url1);
                $("#carImage2").attr("src", baseURL + url2);
                $("#carImage3").attr("src", baseURL + url3);
                $("#carImage4").attr("src", baseURL + url4);


                console.log("ii: "+baseURL+url1);
            },
            error: function (err) {
                console.log(err);
            }
        });
    }


    //----------------Update Car--------------
    $("#btnUpdateCar").click(function (){
        let regNo = $("#txtRegNo").val();
        let brand = $("#txtBrand").val();
        let type =  $("#selectType").val();
        let color = $("#selectColor").val();
        let noOfPassengers = $("#txtNoOfPassengers").val();
        let transmissionType = $("#selectTransmissionType").val();
        let fuelType = $("#selectFuelType").val();
        let dailyRate = $("#txtDailyRate").val();
        let monthlyRate = $("#txtMonthlyRate").val();
        let lossDamageWaiver = $("#txtLossDamageWaiver").val();
        let freeKMForDay = $("#txtFreeKMForDay").val();
        let freeKMForMonth = $("#txtFreeKMForMonth").val();
        let priceForExtraKM = $("#txtPriceForExtraKM").val();
        let status = $("#selectCarStatus").val();

        var car= {
            regNo: regNo,
            brand: brand,
            type: type,
            color: color,
            noOfPassengers: noOfPassengers,
            transmissionType: transmissionType,
            fuelType: fuelType,
            dailyRate: dailyRate,
            monthlyRate: monthlyRate,
            lossDamageWaiver: lossDamageWaiver,
            freeKMForDay: freeKMForDay,
            freeKMForMonth: freeKMForMonth,
            priceForExtraKM: priceForExtraKM,
            status: status
        }

        $.ajax({
            url: baseURL+"car",
            method: "put",
            contentType: "application/json",
            data: JSON.stringify(car),
            dataType: "json",
            success: function (resp){
                alert(resp.message);
                loadAllCars();
            },
            error: function (error){
                var jsObject = JSON.parse(error.responseText).message;
                alert(jsObject.message);
            }
        });
    });

    //----------------Delete Car--------------
    $("#btnDeleteCar").click(function (){
        let regNo = $("#txtRegNo").val();
        $.ajax({
            url: baseURL+"car?regNo="+regNo+"",
            method: "delete",
            dataType: "json",
            success: function (resp){
                alert(resp.message);
                loadAllCars();
            },
            error: function (error){
                alert(JSON.parse(error.responseText).message);
            }
        });
    });

    //----------------Search Car--------------
    $("#btnSearchCar").click(function () {
        let typedRegNo = $("#txtSearchCar").val();
        $.ajax({
            url: baseURL+"car/search/"+typedRegNo,
            method: "get",
            async: true,
            dataType: "json",
            success: function (resp){
                imageLoad(typedRegNo);
                alert(resp.message);
                console.log(resp.data);
                var car = resp.data;
                setCarFormTextFieldValues(car.regNo, car.brand, car.type, car.color, car.noOfPassengers, car.transmissionType, car.fuelType,
                    car.dailyRate, car.monthlyRate, car.lossDamageWaiver, car.freeKMForDay, car.freeKMForMonth, car.priceForExtraKM, car.status);
            },
            error: function (error){
                alert(JSON.parse(error.responseText).message);
            }
        });
    });

    //----------------Add New Car--------------
    $("#btnAddNewCar").click(function () {
        setCarFormTextFieldValues("","","","");
    });

    //----------------Load Car Data to Table--------------
    $("#btnGetAllCars").click(function (){
        loadAllCars();
    });

    function loadAllCars(){
        $("#tblCar").empty();
        $.ajax ({
            url: baseURL+"car",
            dataType: "json",
            success: function (resp) {
                console.log(resp);
                for (let car of resp.data) {
                    var row = '<tr><td>'+car.regNo+'</td><td>'+car.brand+'</td><td>'+car.type+'</td><td>'+car.color+'</td><td>'+car.noOfPassengers+'</td><td>'+car.transmissionType+'</td>' +'<td>'+car.fuelType+'</td><td>'
                        +car.dailyRate+'</td><td>'+car.monthlyRate+'</td><td>'+car.lossDamageWaiver+'</td><td>'+car.freeKMForDay+'</td><td>'+car.freeKMForMonth+'</td><td>'+car.priceForExtraKM+'</td><td>'+car.status+'</td></tr>';
                    $("#tblCar").append(row);
                }
                bindCarTableRowClickEvents();
                setCarFormTextFieldValues("","","","");
                $("#txtRegNo").focus();
            },
            error: function (error){
                var jsObject = JSON.parse(error.responseText).message;
                alert(jsObject.message);
            }
        });
    }


//================================Customer=============================
    //----------------Load Customer Data to Table--------------
    loadAllCustomers();

    function loadAllCustomers(){
        $("#tblCustomerDetails").empty();
        $.ajax ({
            url: baseURL+"customer",
            dataType: "json",
            success: function (resp) {
                console.log(resp);
                for (let customer of resp.data) {
                    var row = '<tr><td>'+customer.id+'</td><td>'+customer.name+'</td><td>'+customer.address+'</td><td>'+customer.contact+'</td><td>'
                              +customer.email+'</td><td>'+customer.drivingLicenseNo+'</td>' +'<td>'+customer.nic+'</td></tr>';
                    $("#tblCustomerDetails").append(row);
                }
            },
            error: function (error){
                var jsObject = JSON.parse(error.responseText).message;
                alert(jsObject.message);
            }
        });
    }


//================================Driver=============================
    loadAllDrivers();

    //----------------Bind Data to InputFields--------------
    function bindDriverTableRowClickEvents() {
        $("#tblDriver>tr").click(function () {
            let driverId = $(this).children(":eq(0)").text();
            let driverName = $(this).children(":eq(1)").text();
            let driverContact = $(this).children(":eq(2)").text();
            let driverUsername = $(this).children(":eq(3)").text();
            let driverPassword = $(this).children(":eq(4)").text();
            let driverStatus = $(this).children(":eq(5)").text();

            $("#txtDriverID").val(driverId);
            $("#txtDriverName").val(driverName);
            $("#txtDriverContact").val(driverContact);
            $("#txtDriverUserName").val(driverUsername);
            $("#txtDriverPassword").val(driverPassword);
            $("#selectedDriverStatus").val(driverStatus);
        });
    }

    //----------------Clear InputFields--------------
    function setDriverFormTextFieldValues(driverId,driverName,driverContact,driverUsername,driverPassword,driverStatus){
        $("#txtDriverID").val(driverId);
        $("#txtDriverName").val(driverName);
        $("#txtDriverContact").val(driverContact);
        $("#txtDriverUserName").val(driverUsername);
        $("#txtDriverPassword").val(driverPassword);
        $("#selectedDriverStatus").val(driverStatus);
    }

    //----------------Save Driver--------------
    $("#btnSaveDriver").click(function (){
        var formData = $("#driverForm").serialize();
        console.log(formData);
        $.ajax({
            url: baseURL+"driver",
            method: "post",
            data: formData,
            dataType: "json",
            success: function (resp){
                alert(resp.message);
                setDriverFormTextFieldValues("","","","");
                loadAllDrivers();
            },
            error: function (error){
                var jsObject = JSON.parse(error.responseText);
                alert(jsObject);
            }
        });
    });

    //----------------Update Driver--------------
    $("#btnUpdateDriver").click(function (){
        let driverId = $("#txtDriverID").val();
        let driverName = $("#txtDriverName").val();
        let driverContact =  $("#txtDriverContact").val();
        let driverUsername = $("#txtDriverUserName").val();
        let driverPassword = $("#txtDriverPassword").val();
        let driverStatus = $("#selectedDriverStatus").val();


        var driver= {
            driverId: driverId,
            driverName: driverName,
            driverContact: driverContact,
            driverUsername: driverUsername,
            driverPassword: driverPassword,
            driverStatus: driverStatus
        }

        $.ajax({
            url: baseURL+"driver",
            method: "put",
            contentType: "application/json",
            data: JSON.stringify(driver),
            dataType: "json",
            success: function (resp){
                alert(resp.message);
                loadAllDrivers();
            },
            error: function (error){
                var jsObject = JSON.parse(error.responseText).message;
                alert(jsObject.message);
            }
        });
    });

    //----------------Delete Driver--------------
    $("#btnDeleteDriver").click(function (){
        let driverId = $("#txtDriverID").val();
        $.ajax({
            url: baseURL+"driver?driverId="+driverId+"",
            method: "delete",
            dataType: "json",
            success: function (resp){
                alert(resp.message);
                loadAllDrivers();
            },
            error: function (error){
                alert(JSON.parse(error.responseText).message);
            }
        });
    });

    //----------------Search Driver--------------
    $("#btnSearchDriver").click(function () {
        let driverId = $("#txtSearchDriver").val();
        $.ajax({
            url: baseURL+"driver?driverId="+driverId+"",
            method: "get",
            dataType: "json",
            success: function (resp){
                alert(resp.message);
                console.log(resp.data);
                var driver = resp.data;
                setDriverFormTextFieldValues(driver.driverId, driver.driverName, driver.driverContact, driver.driverUsername,
                    driver.driverPassword, driver.driverStatus);
            },
            error: function (error){
                alert(JSON.parse(error.responseText).message);
            }
        });
    });

    //----------------Load Driver Data to Table--------------
    $("#btnViewAllDrivers").click(function (){
        loadAllDrivers();
    });

    function loadAllDrivers(){
        $("#tblDriver").empty();
        $.ajax ({
            url: baseURL+"driver",
            dataType: "json",
            success: function (resp) {
                console.log(resp);
                for (let driver of resp.data) {
                    var row = '<tr><td>'+driver.driverId+'</td><td>'+driver.driverName+'</td><td>'+driver.driverContact
                        +'</td><td>'+driver.driverUsername+'</td><td>'+driver.driverPassword+'</td><td>'+driver.driverStatus+'</td></tr>';
                    $("#tblDriver").append(row);
                }
                bindDriverTableRowClickEvents();
                setDriverFormTextFieldValues("","","","");
                $("#txtDriverID").focus();
            },
            error: function (error){
                var jsObject = JSON.parse(error.responseText).message;
                alert(jsObject.message);
            }
        });
    }


    //================================Booking Request=============================
    //----------------Load Booking Request to Table--------------
    loadAllPendingBookingRequests();
    loadAllAvailableDrivers();

    function loadAllPendingBookingRequests(){
        $("#tblBookingRequest").empty();
        $.ajax ({
            url: baseURL+"booking?bookingStatus=pending",
            dataType: "json",
            contentType: "application/json",
            success: function (resp) {
                // console.log(resp);
                // for (let booking of resp.data) {
                //     var row = '<tr><td>'+booking.bookingId+'</td><td>'+booking.bookingDate+'</td><td>'+booking.customerName+'</td><td>'+booking.customerEmail+'</td><td>'
                //         +booking.carRegNo+'</td><td>'+booking.driverId+'</td>' +'<td>'+booking.pickupDate+'</td><td>'+booking.returnDate+'</td><td>'+booking.status+'</td></tr>';
                //     $("#tblBookingRequest").append(row);
                // }


                let pendingReq = resp.data;
                console.log(pendingReq);
                for (let i in pendingReq) {
                    if (pendingReq[i].driver !== null){
                        let rentId = pendingReq[i].bookingId;
                        let rentDate = pendingReq[i].bookingDate;
                        let cusName = pendingReq[i].customer.name;
                        let cusEmail = pendingReq[i].customer.email;
                        let carId = pendingReq[i].car.regNo;
                        let driver = pendingReq[i].driver.driverId;
                        let start = pendingReq[i].pickupDate;
                        let end = pendingReq[i].returnDate;
                        let status = pendingReq[i].status;

                        let row = `<tr><td>${rentId}</td><td>${rentDate}</td><td>${cusName}</td><td>${cusEmail}</td><td>${carId}</td><td>${driver}</td><td>${start}</td><td>${end}</td><td>${status}</td></tr>`;
                        $('#tblBookingRequest').append(row);
                    }else {
                        let rentId = pendingReq[i].bookingId;
                        let rentDate = pendingReq[i].bookingDate;
                        let cusName = pendingReq[i].customer.name;
                        let cusEmail = pendingReq[i].customer.email;
                        let carId = pendingReq[i].car.regNo;
                        // let driver = pendingReq[i].driver;
                        let driver = "No";
                        let start = pendingReq[i].pickupDate;
                        let end = pendingReq[i].returnDate;
                        let status = pendingReq[i].status;

                        let row = `<tr><td>${rentId}</td><td>${rentDate}</td><td>${cusName}</td><td>${cusEmail}</td><td>${carId}</td><td>${driver}</td><td>${start}</td><td>${end}</td><td>${status}</td></tr>`;
                        $('#tblBookingRequest').append(row);
                    }

                }



                bindBookingRequestTableRowClickEvents();
                setBookingRequestFormTextFieldValues("","","","");
                $("#selectAnotherDriver").focus();
            },
            error: function (error){
                var jsObject = JSON.parse(error.responseText).message;
                alert(jsObject.message);
            }
        });
    }

    //----------------Bind Data to InputFields--------------
    function bindBookingRequestTableRowClickEvents() {
        $("#tblBookingRequest>tr").click(function () {
            let bookingId = $(this).children(":eq(0)").text();
            let bookingDate = $(this).children(":eq(1)").text();
            let customerName = $(this).children(":eq(2)").text();
            let customerEmail = $(this).children(":eq(3)").text();
            let carRegNo = $(this).children(":eq(4)").text();
            let driverId = $(this).children(":eq(5)").text();
            let pickupDate = $(this).children(":eq(6)").text();
            let returnDate = $(this).children(":eq(7)").text();
            let bookingStatus = $(this).children(":eq(8)").text();

            $("#txtLoadBookingRequestId").val(bookingId);
            $("#txtLoadBookingDate").val(bookingDate);
            $("#txtLoadCustomerName").val(customerName);
            $("#txtLoadCustomerEmail").val(customerEmail);
            $("#txtLoadCarRegNo").val(carRegNo);
            $("#txtLoadDriverId").val(driverId);
            $("#txtLoadPickupDate").val(pickupDate);
            $("#txtLoadReturnDate").val(returnDate);
            $("#txtLoadBookingStatus").val(bookingStatus);

        });
    }

    //----------------Clear InputFields--------------
    function setBookingRequestFormTextFieldValues(bookingId,bookingDate,customerName,customerEmail,carRegNo,driverId,pickupDate,returnDate,bookingStatus,anotherDriver,denialReason){
        $("#txtLoadBookingRequestId").val(bookingId);
        $("#txtLoadBookingDate").val(bookingDate);
        $("#txtLoadCustomerName").val(customerName);
        $("#txtLoadCustomerEmail").val(customerEmail);
        $("#txtLoadCarRegNo").val(carRegNo);
        $("#txtLoadDriverId").val(driverId);
        $("#txtLoadPickupDate").val(pickupDate);
        $("#txtLoadReturnDate").val(returnDate);
        $("#txtLoadBookingStatus").val(bookingStatus);
        $("#selectAnotherDriver").val(anotherDriver);
        $("#txtDenialReason").val(denialReason);
    }

    //----------------Load All Available Drivers--------------
    function loadAllAvailableDrivers() {
        $("#selectAnotherDriver").empty();
        $.ajax({
            url: baseURL+"driver?driverStatus=Available",
            success: function (res) {
                $("#selectAnotherDriver").append(`<option hidden>Select Another Driver</option>`);
                for (let driver of res.data) {
                    let driverId = driver.driverId;
                    $("#selectAnotherDriver").append(`<option value="${driverId}">${driverId}</option>`);
                }
            },
            error: function (error) {
                let message = JSON.parse(error.responseText).message;
                alert(message);
            }
        });
    }

    //----------------Accept Booking Request--------------
    $("#btnAcceptRequest").click(function (){
        let bookingId = $("#txtLoadBookingRequestId").val();
        let bookingDate = $("#txtLoadBookingDate").val();
        let customerName = $("#txtLoadCustomerName").val();
        let customerEmail = $("#txtLoadCustomerEmail").val();
        let carRegNo = $("#txtLoadCarRegNo").val();
        let driverId;
        let pickupDate = $("#txtLoadPickupDate").val();
        let returnDate = $("#txtLoadReturnDate").val();

        if ($("#selectAnotherDriver").val() !== null){
            driverId = $("#selectAnotherDriver").val();
        }else {
            driverId = $("#txtLoadDriverId").val();
        }

        let car;
        let customer;
        let driver;

        $.ajax({
            url: baseURL+"car/search/"+carRegNo,
            method: "get",
            async: true,
            dataType: "json",
            success: function (resp){
                // alert(resp.message);
                console.log(resp.data);
                const data = resp.data;
                console.log(resp.data.regNo);
                car = resp.data;

                $.ajax({
                    url: baseURL+"customer?email="+customerEmail+"",
                    method: "get",
                    dataType: "json",
                    success: function (resp){
                        // alert(resp.message);
                        console.log(resp.data);
                        customer = resp.data;

                        $.ajax({
                            url: baseURL+"driver?driverId="+driverId,
                            method: "get",
                            dataType: "json",
                            success: function (resp){
                                // alert(resp.message);
                                console.log(resp.data);
                                driver = resp.data;

                                $.ajax({
                                    url: baseURL+"booking",
                                    method: "put",
                                    contentType: "application/json",
                                    data: JSON.stringify(
                                        {
                                            bookingId: parseInt(bookingId),
                                            bookingDate: bookingDate,
                                            pickupDate: pickupDate,
                                            returnDate: returnDate,
                                            status: "Accepted",
                                            car: car,
                                            customer: customer,
                                            driver: driver
                                        }
                                    ),

                                    success: function (resp){
                                        alert(resp.message);

                                        //Update Car Status
                                        $.ajax({
                                            url: baseURL+"car",
                                            method: "put",
                                            contentType: "application/json",
                                            data: JSON.stringify(
                                                {
                                                    regNo: car.regNo,
                                                    brand: car.brand,
                                                    type: car.type,
                                                    color: car.color,
                                                    noOfPassengers: car.noOfPassengers,
                                                    transmissionType: car.transmissionType,
                                                    fuelType: car.fuelType,
                                                    dailyRate: car.dailyRate,
                                                    monthlyRate: car.monthlyRate,
                                                    lossDamageWaiver: car.lossDamageWaiver,
                                                    freeKMForDay: car.freeKMForDay,
                                                    freeKMForMonth: car.freeKMForMonth,
                                                    priceForExtraKM: car.priceForExtraKM,
                                                    status: "On Hire"
                                                }
                                            ),
                                            dataType: "json",
                                            success: function (resp){
                                                alert(resp.message);
                                                loadAllCars();
                                            },
                                            error: function (error){
                                                var jsObject = JSON.parse(error.responseText).message;
                                                alert(jsObject.message);
                                            }
                                        });

                                        if (driverId !== "No"){
                                            //Update Driver Status
                                            $.ajax({
                                                url: baseURL+"driver",
                                                method: "put",
                                                contentType: "application/json",
                                                data: JSON.stringify(
                                                    {
                                                        driverId: driver.driverId,
                                                        driverName: driver.driverName,
                                                        driverContact: driver.driverContact,
                                                        driverUsername: driver.driverUsername,
                                                        driverPassword: driver.driverPassword,
                                                        driverStatus: "On Hire"
                                                    }
                                                ),
                                                dataType: "json",
                                                success: function (resp){
                                                    alert(resp.message);
                                                    loadAllDrivers();

                                                //Update Booking Request Table and Available Drivers List
                                                // loadAllAvailableDrivers();
                                                    loadAllPendingBookingRequests();
                                                setBookingRequestFormTextFieldValues();
                                                },
                                                error: function (error){
                                                    var jsObject = JSON.parse(error.responseText).message;
                                                    alert(jsObject.message);
                                                }
                                            });
                                        } else {
                                            //Update Booking Request Table and Available Drivers List
                                            loadAllAvailableDrivers();
                                            loadAllPendingBookingRequests();
                                            setBookingRequestFormTextFieldValues();
                                        }
                                    },
                                    error: function (error){
                                        var jsObject = JSON.parse(error.responseText).message;
                                        alert(jsObject.message);
                                    }
                                });
                            }
                        });
                    }
                });
            }
        });
    });

    //----------------Deny Booking Request--------------
    $("#btnDenyRequest").click(function (){
        let bookingId = $("#txtLoadBookingRequestId").val();
        let bookingDate = $("#txtLoadBookingDate").val();
        let customerName = $("#txtLoadCustomerName").val();
        let customerEmail = $("#txtLoadCustomerEmail").val();
        let carRegNo = $("#txtLoadCarRegNo").val();
        let driverId;
        let pickupDate = $("#txtLoadPickupDate").val();
        let returnDate = $("#txtLoadReturnDate").val();

        driverId = $("#txtLoadDriverId").val();

        let denialReason = $("#txtDenialReason").val();

        let car;
        let customer;
        let driver;

        $.ajax({
            url: baseURL+"car/search/"+carRegNo,
            method: "get",
            async: true,
            dataType: "json",
            success: function (resp){
                // alert(resp.message);
                console.log(resp.data);
                const data = resp.data;
                console.log(resp.data.regNo);
                car = resp.data;

                $.ajax({
                    url: baseURL+"customer?email="+customerEmail+"",
                    method: "get",
                    dataType: "json",
                    success: function (resp){
                        // alert(resp.message);
                        console.log(resp.data);
                        customer = resp.data;

                        $.ajax({
                            url: baseURL+"driver?driverId="+driverId,
                            method: "get",
                            dataType: "json",
                            success: function (resp){
                                // alert(resp.message);
                                console.log(resp.data);
                                driver = resp.data;

                                $.ajax({
                                    url: baseURL+"booking",
                                    method: "put",
                                    contentType: "application/json",
                                    data: JSON.stringify(
                                        {
                                            bookingId: parseInt(bookingId),
                                            bookingDate: bookingDate,
                                            pickupDate: pickupDate,
                                            returnDate: returnDate,
                                            status: "Deny: "+denialReason,
                                            car: car,
                                            customer: customer,
                                            driver: driver
                                        }
                                    ),

                                    success: function (resp){
                                        alert(resp.message);

                                        loadAllPendingBookingRequests();
                                        setBookingRequestFormTextFieldValues();

                                    },
                                    error: function (error){
                                        var jsObject = JSON.parse(error.responseText).message;
                                        alert(jsObject.message);
                                    }
                                });
                            }
                        });
                    }
                });
            }
        });
    });


    //================================Booking=============================
    //----------------Load Booking to Table--------------
    loadAllAcceptedBookingRequests();

    function loadAllAcceptedBookingRequests(){
        $("#tblBooking").empty();
        $.ajax ({
            url: baseURL+"booking?bookingStatus=Accepted",
            dataType: "json",
            contentType: "application/json",
            success: function (resp) {
                // console.log(resp);
                // for (let booking of resp.data) {
                //     var row = '<tr><td>'+booking.bookingId+'</td><td>'+booking.bookingDate+'</td><td>'+booking.customerName+'</td><td>'+booking.customerEmail+'</td><td>'
                //         +booking.carRegNo+'</td><td>'+booking.driverId+'</td>' +'<td>'+booking.pickupDate+'</td><td>'+booking.returnDate+'</td><td>'+booking.status+'</td></tr>';
                //     $("#tblBookingRequest").append(row);
                // }


                let pendingReq = resp.data;
                console.log(pendingReq);
                for (let i in pendingReq) {
                    if (pendingReq[i].driver !== null){
                        let rentId = pendingReq[i].bookingId;
                        let rentDate = pendingReq[i].bookingDate;
                        let cusName = pendingReq[i].customer.name;
                        let cusEmail = pendingReq[i].customer.email;
                        let carId = pendingReq[i].car.regNo;
                        let driver = pendingReq[i].driver.driverId;
                        let start = pendingReq[i].pickupDate;
                        let end = pendingReq[i].returnDate;
                        let status = pendingReq[i].status;

                        let row = `<tr><td>${rentId}</td><td>${rentDate}</td><td>${cusName}</td><td>${cusEmail}</td><td>${carId}</td><td>${driver}</td><td>${start}</td><td>${end}</td><td>${status}</td></tr>`;
                        $('#tblBooking').append(row);
                    }else {
                        let rentId = pendingReq[i].bookingId;
                        let rentDate = pendingReq[i].bookingDate;
                        let cusName = pendingReq[i].customer.name;
                        let cusEmail = pendingReq[i].customer.email;
                        let carId = pendingReq[i].car.regNo;
                        let driver = pendingReq[i].driver;
                        let start = pendingReq[i].pickupDate;
                        let end = pendingReq[i].returnDate;
                        let status = pendingReq[i].status;

                        let row = `<tr><td>${rentId}</td><td>${rentDate}</td><td>${cusName}</td><td>${cusEmail}</td><td>${carId}</td><td>${driver}</td><td>${start}</td><td>${end}</td><td>${status}</td></tr>`;
                        $('#tblBooking').append(row);
                    }

                }
            },
            error: function (error){
                var jsObject = JSON.parse(error.responseText).message;
                alert(jsObject.message);
            }
        });
    }

    //================================Payment=============================
    //----------------Load Booking Details to TextFields--------------

    //----------------Get Current Date--------------
    function getCurrentDate(){
        const date = new Date();
        let day = date.getDate();
        let month = date.getMonth() + 1;
        let year = date.getFullYear();

        if (day < 10) day = '0' + day;
        if (month < 10) month = '0' + month;

        return `${year}-${month}-${day}`;
    }

    $("#txtDate").val(getCurrentDate());

    //----------------Search Booking--------------
    $("#btnSearchBooking").click(function () {
        loadBookingDetailsByBookingId();
    });

    function loadBookingDetailsByBookingId() {
        let bookingId = $("#txtSearchBooking").val();
        parseInt(bookingId);
        $.ajax ({
            url: baseURL+"booking?bookingId="+bookingId,
            dataType: "json",
            contentType: "application/json",
            success: function (resp) {
                let booking = resp.data;

                if (booking.driver !== null) {
                    $("#txtLoadBookingId").val(booking.bookingId);
                    $("#txtLoadDriverId1").val(booking.driver.driverId);
                    $("#txtPickup").val(booking.pickupDate);
                    $("#txtReturn").val(booking.returnDate);
                }else {
                    $("#txtLoadBookingId").val(booking.bookingId);
                    $("#txtLoadDriverId1").val("No");
                    $("#txtPickup").val(booking.pickupDate);
                    $("#txtReturn").val(booking.returnDate);
                }

                //----------------Get Car Loss Damage Waiver--------------
                let carRegNo = booking.car.regNo;
                $.ajax ({
                    url: baseURL+"car/search/"+carRegNo,
                    dataType: "json",
                    contentType: "application/json",
                    async: false,
                    success: function (resp) {
                        let car = resp.data;
                        $("#txtLossDamageWaiverPaidAmount").val(car.lossDamageWaiver);
                        console.log("Car"+car.brand);

                        //----------------Calculate Rent for using days--------------
                        let pickupDate = new Date(booking.pickupDate);
                        let returnDate = new Date(booking.returnDate);
                        let diffOfTime = returnDate.getTime()-pickupDate.getTime();
                        let diffOfDays = diffOfTime / (1000*3600*24);

                        $("#txtRentDuration").val(diffOfDays);
                        console.log("Days: "+diffOfDays);

                        let dailyRate = car.dailyRate;
                        $("#txtLoadDailyRate").val(dailyRate);

                        $("#txtRentForUsingDays").val(dailyRate * diffOfDays);

                        $("#txtCostForExtraKM").val(car.priceForExtraKM);

                        let freeKM = car.freeKMForDay;

                        calculateRemainLossDamageWaiverPayment();

                        calculateExtraKM(freeKM);

                        calculateTotalCostOfExtraKM();
                    }
                });
            }
        });
    }

    function calculateRemainLossDamageWaiverPayment(){
        let damageCost = $("#txtDamageCost").val();
        $("#txtRemain").val($("#txtLossDamageWaiverPaidAmount").val() - damageCost);
    }

    function calculateExtraKM(freeKM){
        let totalKM = $("#txtTotalKM").val();

        let extraKM;
        if (freeKM<totalKM){
            extraKM = totalKM - freeKM;
        }else {
            extraKM = 0;
        }
        $("#txtExtraKM").val(extraKM);
        return extraKM;
    }

    function calculateTotalCostOfExtraKM(){
        let totCostOfExtraKM = $("#txtExtraKM").val() * $("#txtCostForExtraKM").val();
        $("#txtTotalCostForExtraKM").val(totCostOfExtraKM);
        return totCostOfExtraKM;
    }

    function calculateTotalPayment(){
        let totalPayment;
        let totalCostForExtraKM = parseFloat($("#txtTotalCostForExtraKM").val());
        let rentForUsingDays = parseFloat($("#txtRentForUsingDays").val());
        let driverPayment = parseFloat($("#txtDriverPayment").val());
        let remainLossDamageWaiver = parseFloat($("#txtRemain").val());
        totalPayment = (totalCostForExtraKM + rentForUsingDays + driverPayment) - remainLossDamageWaiver;
        $("#txtTotalPayment").val(totalPayment.toString());
        console.log("Total: "+totalPayment.toString());
    }

    //----------------Calculate Total Payment--------------
    $("#btnCalculate").click(function () {
        loadBookingDetailsByBookingId();
        setInterval(calculateTotalPayment,100);
        // calculateTotalPayment();
    });

    //----------------Calculate Balance--------------
    $(document).ready(function (){
        $("#txtCash").on('input',function () {
            let cash = $(this).val();
            cash -= $("#txtTotalPayment").val();
            $("#txtBalance").val(cash);
        });
    });

    //----------------Send Payment--------------
    $("#btnPaid").click(function () {
        let bookingId = $("#txtLoadBookingId").val();
        parseInt(bookingId);

        let paymentDate= $("#txtDate").val();
        let booking;
        let amount = $("#txtTotalPayment").val();

        let driverId = $("#txtLoadDriverId1").val();

        let car;
        let driver;

        $.ajax ({
            url: baseURL+"booking?bookingId="+bookingId,
            dataType: "json",
            contentType: "application/json",
            success: function (resp) {
                booking = resp.data;
                console.log("Data: "+resp.data.bookingId)

                $.ajax({
                    url: baseURL + "payment",
                    method: 'post',
                    contentType: "application/json",
                    data: JSON.stringify(
                        {
                            paymentDate: paymentDate,
                            amount: amount,
                            booking: booking
                        }
                    ),
                    success: function (resp) {
                        console.log(resp)

                        //Update Car Status
                        $.ajax({
                            url: baseURL+"car",
                            method: "put",
                            contentType: "application/json",
                            async: false,
                            data: JSON.stringify(
                                {
                                    regNo: booking.car.regNo,
                                    brand: booking.car.brand,
                                    type: booking.car.type,
                                    color: booking.car.color,
                                    noOfPassengers: booking.car.noOfPassengers,
                                    transmissionType: booking.car.transmissionType,
                                    fuelType: booking.car.fuelType,
                                    dailyRate: booking.car.dailyRate,
                                    monthlyRate: booking.car.monthlyRate,
                                    lossDamageWaiver: booking.car.lossDamageWaiver,
                                    freeKMForDay: booking.car.freeKMForDay,
                                    freeKMForMonth: booking.car.freeKMForMonth,
                                    priceForExtraKM: booking.car.priceForExtraKM,
                                    status: "Available"
                                }
                            ),
                            dataType: "json",
                            success: function (resp){
                                alert(resp.message);
                                loadAllCars();
                            },
                            error: function (error){
                                var jsObject = JSON.parse(error.responseText).message;
                                alert(jsObject.message);
                            }
                        });

                        if (driverId !== "No"){
                            //Update Driver Status
                            $.ajax({
                                url: baseURL+"driver",
                                method: "put",
                                contentType: "application/json",
                                data: JSON.stringify(
                                    {
                                        driverId: booking.driver.driverId,
                                        driverName: booking.driver.driverName,
                                        driverContact: booking.driver.driverContact,
                                        driverUsername: booking.driver.driverUsername,
                                        driverPassword: booking.driver.driverPassword,
                                        driverStatus: "Available"
                                    }
                                ),
                                dataType: "json",
                                success: function (resp){

                                    // //Update Booking Status
                                    // $.ajax({
                                    //     url: baseURL+"booking",
                                    //     method: "put",
                                    //     contentType: "application/json",
                                    //     data: JSON.stringify(
                                    //         {
                                    //             bookingId: parseInt(bookingId),
                                    //             bookingDate: booking.bookingDate,
                                    //             pickupDate: booking.pickupDate,
                                    //             returnDate: booking.returnDate,
                                    //             status: "Rented",
                                    //             car: booking.car,
                                    //             customer: booking.customer,
                                    //             driver: booking.driver
                                    //         }
                                    //     ),
                                    //
                                    //     success: function (resp){
                                    //         alert(resp.message);
                                    //
                                    //         loadAllPendingBookingRequests();
                                    //         setBookingRequestFormTextFieldValues();
                                    //
                                    //     },
                                    //     error: function (error){
                                    //         var jsObject = JSON.parse(error.responseText).message;
                                    //         alert(jsObject.message);
                                    //     }
                                    // });
                                    //
                                    // alert(resp.message);
                                    // loadAllDrivers();
                                    //
                                    // //Update Booking Request Table and Available Drivers List
                                    // // loadAllAvailableDrivers();
                                    // loadAllPendingBookingRequests();
                                    // setBookingRequestFormTextFieldValues();
                                },
                                error: function (error){
                                    var jsObject = JSON.parse(error.responseText).message;
                                    alert(jsObject.message);
                                }
                            });
                        }

                        //Update Booking Status
                        $.ajax({
                            url: baseURL+"booking",
                            method: "put",
                            contentType: "application/json",
                            data: JSON.stringify(
                                {
                                    bookingId: parseInt(bookingId),
                                    bookingDate: booking.bookingDate,
                                    pickupDate: booking.pickupDate,
                                    returnDate: booking.returnDate,
                                    status: "Rented",
                                    car: booking.car,
                                    customer: booking.customer,
                                    driver: booking.driver
                                }
                            ),

                            success: function (resp){
                                alert(resp.message);

                                loadAllPendingBookingRequests();
                                setBookingRequestFormTextFieldValues();

                            },
                            error: function (error){
                                var jsObject = JSON.parse(error.responseText).message;
                                alert(jsObject.message);
                            }
                        });

                        alert(resp.message);
                        loadAllDrivers();

                        //Update Booking Request Table and Available Drivers List
                        // loadAllAvailableDrivers();
                        loadAllPendingBookingRequests();
                        setBookingRequestFormTextFieldValues();





                            //Update Booking Request Table and Available Drivers List
                            loadAllAvailableDrivers();
                            loadAllPendingBookingRequests();
                            setBookingRequestFormTextFieldValues();


                        alert("Paid Successfully");
                        setPaymentFormTextFieldValues("");
                    },
                    error: function (err) {
                        console.log(err);
                    }
                });
            }
        });
    });

    //----------------Clear InputFields--------------
    function setPaymentFormTextFieldValues(bookingId,paymentDate,pickupDate,returnDate,lossDWPAmount,damageCost,lossDWRemain,driverID1,driverPayment,
                                           rentDuration,rentForUsingDays,totalKM,costForExtraKM,totalPayment,cash,balance){
        $("#txtLoadBookingId").val(bookingId);
        $("#txtDate").val(paymentDate);
        $("#txtPickup").val(pickupDate);
        $("#txtReturn").val(returnDate);
        $("#txtLossDamageWaiverPaidAmount").val(lossDWPAmount);
        $("#txtDamageCost").val(damageCost);
        $("#txtRemain").val(lossDWRemain);
        $("#txtLoadDriverId1").val(driverID1);
        $("#txtDriverPayment").val(driverPayment);
        $("#txtRentDuration").val(rentDuration);
        $("#txtRentForUsingDays").val(rentForUsingDays);
        $("#txtTotalKM").val(totalKM);
        $("#txtCostForExtraKM").val(costForExtraKM);
        $("#txtTotalPayment").val(totalPayment);
        $("#txtCash").val(cash);
        $("#txtBalance").val(balance);
    }
</script>
</body>
</html>